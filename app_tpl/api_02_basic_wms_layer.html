<!doctype html>
<html class="no-js">
	<head>
		include "head.html"
	</head>
	<body>
		<!--[if lt IE 10]>
		<p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
		<![endif]-->

		<div class="container">

			include "header.html"

			<h2>Load WMS layer</h2>

			<p>
				This sample shows how to load a WMS layer. Passing layer name by GET parameter as <i><b>layer=layer_name</b></i> you can load it on map, e.g. <a href="./api_02_basic_wms_layer.html?layer=CARTO_TMB">?layer=CARTO_TMB</a>
			</p>

			<div id="map" class="map"></div>

            include "text-muted.html"

            include "footer.html"


		</div>

		include "tail.html"

		include "ganalytics.html"

		<script>
			var write_here_your_app_key = 'd9905ec9b70bc6aca11e39be3cd0d856';
			var write_here_your_app_id = 'df5c473f';
		</script>

		<script id="code">

			/**
			 * Get layer parameter from URL
			 * @param key
			 * @returns {*}
			 */
			var getURLParameters = function(key) {
				var KEY = 0, VALUE = 1;
				var onlyParameters = window.location.href.split('?')[1];
				if ( typeof onlyParameters == "undefined") {
					return null;
				}
				var parametersAsString = onlyParameters.split('&');
				var parameters = {};
				for (var pair = 0; pair < parametersAsString.length; pair++) {
					var keyAndValue = parametersAsString[pair].split('=');
					if (keyAndValue[KEY] == key) {
						console.log(keyAndValue[VALUE]);
						return keyAndValue[VALUE];
					}
				}
				return null;
			};

			var layers = [new ol.layer.Tile({
				source : new ol.source.TileWMS({
					params : {
						'LAYERS' : 'OI.OrthoimageCoverage',
						'FORMAT' : 'image/png'
					},
					url : 'http://www.ign.es/wms-inspire/pnoa-ma'
				})
			})];

			var map = new ol.Map({
				layers : layers,
				target : 'map',
				view : new ol.View({
					center : new ol.proj.transform([2.1574, 41.3987], "EPSG:4326", "EPSG:3857"),
					projection : 'EPSG:3857',
					zoom : 13
				})
			});

			var nameLayer = getURLParameters('layer');

			if (!nameLayer) {
				nameLayer = 'XARXA_METRO';
			};

			var overlay = new ol.layer.Tile({
				source : new ol.source.TileWMS({
					params : {
						'LAYERS' : nameLayer,
						'FORMAT' : 'image/png',
						'app_key' : write_here_your_app_key,
						'app_id' : write_here_your_app_id,
						'name' : nameLayer
					},
					url : 'http://api.tmb.cat/v1/maps/wms'
				})
			})

			map.addLayer(overlay);
		</script>

		include "sourcecode.html"

	</body>
</html>
